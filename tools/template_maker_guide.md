# iPad游戏模板制作工具使用指南

## 工具概述

模板制作工具是一个图形化界面工具，帮助您从iPad游戏截图中提取和制作各种游戏界面元素的模板。这些模板将用于游戏自动化脚本中的图像识别和匹配。

## 启动工具

```bash
cd /Users/liuweigang/sgzAss
python tools/template_maker.py
```

## 界面说明

### 左侧控制面板

1. **截图选择区域**
   - "选择截图文件"：手动选择特定的截图文件
   - "加载最新截图"：自动加载最新的游戏截图
   - 当前截图文件名显示

2. **模板制作区域**
   - **模板名称**：从预定义的下拉列表中选择模板名称，包括：
     - 基础界面：main_menu、world_map、battle_interface等
     - 按钮类：attack_button、move_button、collect_button等
     - 队伍相关：troop_icon、cavalry_icon、infantry_icon等
     - 地块相关：empty_land、occupied_land、resource_land等
     - 资源相关：food_icon、wood_icon、stone_icon等
     - 建筑相关：castle_icon、barracks_icon、stable_icon等
     - 状态指示器：health_bar、energy_bar、progress_bar等
     - 对话框和弹窗：dialog_box、popup_window、alert_dialog等
     - 地图元素：player_marker、enemy_marker、ally_marker等
     - 其他常用：search_button、filter_button、sort_button等
     - custom_template：选择此项可输入自定义名称
   - **模板类型**：选择模板类型
     - `button`：按钮类模板
     - `icon`：图标类模板
     - `menu`：菜单类模板
     - `dialog`：对话框类模板
     - `text`：文本类模板
     - `other`：其他类型
   - **描述**：可选的详细描述
   - "保存当前选择为模板"：将选中区域保存为模板文件

3. **选择信息区域**
   - 显示当前选择区域的坐标和尺寸信息

4. **已制作模板列表**
   - 显示本次会话中已制作的所有模板
   - 包含模板名称、类型和尺寸信息

5. **操作按钮**
   - "导出模板信息"：将模板信息导出为JSON文件
   - "清除所有选择"：清除当前的选择区域

### 右侧图像显示区域

- 显示当前加载的游戏截图
- **左键拖拽**：选择模板区域
- **右键拖拽**：移动图片位置（解决大图显示问题）
- **鼠标滚轮**：缩放图片大小
- 红色矩形框显示当前选择的区域

## 使用步骤

### 1. 加载截图

启动工具后，会自动加载最新的游戏截图。如果需要使用其他截图，可以点击"选择截图文件"按钮。

### 2. 调整图片视图（新功能）

在右侧图像区域中：
- **移动图片**：按住鼠标右键拖拽，可以移动大图的显示位置
- **缩放图片**：使用鼠标滚轮向上滚动放大，向下滚动缩小
- 这些功能帮助您更好地查看和操作大尺寸截图

### 3. 选择模板区域

在右侧图像区域中：
1. 按住鼠标左键并拖拽，选择要制作模板的区域
2. 松开鼠标后，会显示红色选择框
3. 左侧会显示选择区域的坐标和尺寸信息

### 4. 设置模板信息

在左侧控制面板中：
1. 从下拉列表中选择预定义的模板名称，或选择"custom_template"输入自定义名称
2. 选择合适的模板类型
3. 可选：输入模板描述

### 5. 保存模板

点击"保存当前选择为模板"按钮，模板将被保存到 `resources/templates/` 目录中。

### 6. 继续制作其他模板

重复步骤3-5，制作更多模板。

### 7. 导出模板信息

完成所有模板制作后，点击"导出模板信息"按钮，将模板的详细信息（包括坐标、尺寸等）导出为JSON文件，便于后续使用。

## 建议制作的模板类型

### 基础界面模板
1. **main_menu** - 主菜单界面标识
2. **world_map** - 世界地图界面标识
3. **battle_interface** - 战斗界面标识

### 按钮模板
1. **attack_button** - 攻击按钮
2. **move_button** - 移动按钮
3. **collect_button** - 收集按钮
4. **back_button** - 返回按钮
5. **confirm_button** - 确认按钮
6. **cancel_button** - 取消按钮

### 图标模板
1. **resource_icon** - 资源图标
2. **troop_icon** - 部队图标
3. **building_icon** - 建筑图标
4. **land_icon** - 土地图标

### 状态指示器
1. **health_bar** - 生命值条
2. **energy_bar** - 能量条
3. **progress_bar** - 进度条

## 注意事项

1. **模板命名**：优先使用预定义的模板名称，确保命名规范统一
2. **自定义命名**：仅在预定义列表中没有合适选项时使用自定义名称，使用英文和下划线
3. **选择精度**：尽量精确选择目标区域，避免包含过多背景
4. **模板大小**：确保选择的区域足够大（至少10x10像素）
5. **重复元素**：对于游戏中重复出现的元素，只需制作一个模板
6. **保存位置**：所有模板自动保存到 `resources/templates/` 目录
7. **命名一致性**：使用预定义名称可确保与游戏自动化脚本的兼容性

## 故障排除

### 工具无法启动
- 确保已安装所需依赖：`pip install pillow opencv-python`
- 检查Python环境是否正确

### 无法加载截图
- 确保 `resources/screenshots/` 目录存在且包含截图文件
- 检查截图文件格式（支持PNG、JPG）

### 选择区域无响应
- 确保截图已正确加载
- 尝试重新启动工具

## 完成后的下一步

制作完成所有需要的模板后：
1. 检查 `resources/templates/` 目录中的模板文件
2. 导出模板信息JSON文件作为备份
3. 更新游戏自动化脚本中的模板路径和名称
4. 测试模板在实际游戏中的识别效果

---

**提示**：建议先制作几个基础模板进行测试，确认识别效果良好后再制作更多模板。